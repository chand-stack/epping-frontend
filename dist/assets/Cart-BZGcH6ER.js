import{j as t,l as h,q as Xe,r as w,s as Qe,t as Se,v as De,T as Ee,w as Pe,O as ke}from"./ui-RojGIA-k.js";import{c as Ze,u as le,C as X,a as Q,B as j,X as Oe,e as B,t as I,g as et,h as tt,f as rt,L as G}from"./index-ppAren82.js";import{M as st,P as nt,a as re}from"./api-DsUKC986.js";import{L as ce,o as at,T as it}from"./orderManagement-zvivOot4.js";import{g as ot}from"./vendor-gH-7aFTg.js";import{L as lt,A as he}from"./lock-Bn3FBp61.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],D=Ze("credit-card",ct),dt=({item:s})=>{const{updateQuantity:e,removeItem:r}=le(),n=l=>{e(s.id,l)},a=()=>{r(s.id)},o=l=>{switch(l){case"OhSmash":return"text-ohsmash";case"Wonder Wings":return"text-wonder-wings";case"Okra Green":return"text-okra-green";default:return"text-primary"}};return t.jsx(X,{className:"hover:shadow-md transition-shadow",children:t.jsx(Q,{className:"p-4",children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-2xl",children:s.brand==="OhSmash"?"üçî":s.brand==="Wonder Wings"?"üçó":"üçõ"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-lg truncate",children:s.name}),t.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.description}),t.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[t.jsx("span",{className:`text-sm font-medium ${o(s.brand)}`,children:s.brand}),s.options?.sauce&&t.jsx("span",{className:"text-xs bg-secondary px-2 py-1 rounded",children:s.options.sauce}),s.options?.size&&t.jsx("span",{className:"text-xs bg-secondary px-2 py-1 rounded",children:s.options.size})]})]}),t.jsx(j,{variant:"ghost",size:"sm",onClick:a,className:"text-muted-foreground hover:text-destructive",children:t.jsx(Oe,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"flex items-center justify-between mt-3",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(j,{variant:"outline",size:"sm",onClick:()=>n(s.quantity-1),disabled:s.quantity<=1,className:"w-8 h-8 p-0",children:t.jsx(st,{className:"w-3 h-3"})}),t.jsx("span",{className:"w-8 text-center font-medium",children:s.quantity}),t.jsx(j,{variant:"outline",size:"sm",onClick:()=>n(s.quantity+1),className:"w-8 h-8 p-0",children:t.jsx(nt,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"text-right",children:[t.jsxs("div",{className:"font-semibold",children:["¬£",(s.price*s.quantity).toFixed(2)]}),s.quantity>1&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["¬£",s.price.toFixed(2)," each"]})]})]})]})]})})})};class ut{restaurantEmail="eppingfoodcourt@gmail.com";restaurantName="Epping Food Court";async sendOrderConfirmationEmail(e){try{const r=this.generateOrderConfirmationEmail(e);return console.log("üìß Order Confirmation Email:",{to:e.customerEmail,subject:`Order Confirmation #${e.orderId} - ${this.restaurantName}`,content:r}),await this.simulateEmailSending(e.customerEmail,r),!0}catch(r){return console.error("Failed to send order confirmation email:",r),!1}}async sendRestaurantNotificationEmail(e){try{const r=this.generateRestaurantNotificationEmail(e);return console.log("üìß Restaurant Notification Email:",{to:this.restaurantEmail,subject:`New Order #${e.orderId} - ${e.orderType.toUpperCase()}`,content:r}),await this.simulateEmailSending(this.restaurantEmail,r),!0}catch(r){return console.error("Failed to send restaurant notification email:",r),!1}}generateOrderConfirmationEmail(e){const r=e.orderType==="delivery"?"Delivery":"Pickup",n=this.getPaymentMethodText(e.paymentMethod);return`
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Order Confirmation - ${this.restaurantName}</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { background: #000; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; background: #f9f9f9; }
        .order-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .total { font-weight: bold; font-size: 18px; color: #000; }
        .footer { text-align: center; padding: 20px; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üçî ${this.restaurantName}</h1>
            <h2>Order Confirmation</h2>
        </div>
        
        <div class="content">
            <h3>Thank you for your order, ${e.customerName}!</h3>
            <p>Your order has been received and is being prepared.</p>
            
            <div class="order-details">
                <h4>Order Details</h4>
                <p><strong>Order ID:</strong> #${e.orderId}</p>
                <p><strong>Order Type:</strong> ${r}</p>
                <p><strong>Payment Method:</strong> ${n}</p>
                <p><strong>Phone:</strong> ${e.customerPhone}</p>
                
                ${e.orderType==="delivery"&&e.deliveryAddress?`
                <p><strong>Delivery Address:</strong><br>
                ${e.deliveryAddress.street}<br>
                ${e.deliveryAddress.city} ${e.deliveryAddress.postcode}</p>
                `:""}
                
                ${e.estimatedTime?`<p><strong>Estimated Time:</strong> ${e.estimatedTime}</p>`:""}
                
                ${e.specialInstructions?`<p><strong>Special Instructions:</strong> ${e.specialInstructions}</p>`:""}
            </div>
            
            <div class="order-details">
                <h4>Your Order</h4>
                ${e.items.map(a=>`
                <div class="item">
                    <span>${a.quantity}x ${a.name}</span>
                    <span>¬£${(a.price*a.quantity).toFixed(2)}</span>
                </div>
                `).join("")}
                <div class="item total">
                    <span>Total</span>
                    <span>¬£${e.total.toFixed(2)}</span>
                </div>
            </div>
            
            <p>We'll contact you when your order is ready for ${e.orderType==="delivery"?"delivery":"pickup"}.</p>
            
            <p>If you have any questions, please call us at <strong>01992279414</strong>.</p>
        </div>
        
        <div class="footer">
            <p>${this.restaurantName}<br>
            53 High St, Epping CM16 4BA, UK<br>
            Phone: 01992279414</p>
        </div>
    </div>
</body>
</html>
    `}generateRestaurantNotificationEmail(e){const r=e.orderType==="delivery"?"DELIVERY":"PICKUP",n=this.getPaymentMethodText(e.paymentMethod);return`
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>New Order #${e.orderId} - ${this.restaurantName}</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { background: #dc2626; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; background: #f9f9f9; }
        .order-details { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; border-left: 4px solid #dc2626; }
        .item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .total { font-weight: bold; font-size: 18px; color: #dc2626; }
        .urgent { background: #fef2f2; border: 1px solid #fecaca; padding: 15px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üö® NEW ORDER ALERT</h1>
            <h2>Order #${e.orderId} - ${r}</h2>
        </div>
        
        <div class="content">
            <div class="urgent">
                <h3>‚ö†Ô∏è Action Required</h3>
                <p>A new order has been placed and requires your attention.</p>
            </div>
            
            <div class="order-details">
                <h4>Customer Information</h4>
                <p><strong>Name:</strong> ${e.customerName}</p>
                <p><strong>Phone:</strong> ${e.customerPhone}</p>
                <p><strong>Email:</strong> ${e.customerEmail}</p>
                <p><strong>Order Type:</strong> ${r}</p>
                <p><strong>Payment Method:</strong> ${n}</p>
                
                ${e.orderType==="delivery"&&e.deliveryAddress?`
                <p><strong>Delivery Address:</strong><br>
                ${e.deliveryAddress.street}<br>
                ${e.deliveryAddress.city} ${e.deliveryAddress.postcode}</p>
                `:""}
                
                ${e.estimatedTime?`<p><strong>Estimated Time:</strong> ${e.estimatedTime}</p>`:""}
                
                ${e.specialInstructions?`<p><strong>Special Instructions:</strong> ${e.specialInstructions}</p>`:""}
            </div>
            
            <div class="order-details">
                <h4>Order Items</h4>
                ${e.items.map(a=>`
                <div class="item">
                    <span>${a.quantity}x ${a.name}</span>
                    <span>¬£${(a.price*a.quantity).toFixed(2)}</span>
                </div>
                `).join("")}
                <div class="item total">
                    <span>Total</span>
                    <span>¬£${e.total.toFixed(2)}</span>
                </div>
            </div>
            
            <p><strong>Next Steps:</strong></p>
            <ul>
                <li>Confirm the order with the customer</li>
                <li>Begin food preparation</li>
                <li>Update order status in the admin dashboard</li>
                <li>Contact customer when ready for ${e.orderType==="delivery"?"delivery":"pickup"}</li>
            </ul>
        </div>
    </div>
</body>
</html>
    `}getPaymentMethodText(e){switch(e){case"cash_on_delivery":return"üí∞ Cash on Delivery";case"pay_at_pickup":return"üíµ Pay at Pickup";case"card":return"üí≥ Card (Online)";case"online":return"üåê Online Payment";default:return e}}async simulateEmailSending(e,r){await new Promise(n=>setTimeout(n,1e3)),console.log(`‚úÖ Email sent to: ${e}`)}}const fe=new ut;var Te="clover",mt=function(e){return e===3?"v3":e},Re="https://js.stripe.com",pt="".concat(Re,"/").concat(Te,"/stripe.js"),ht=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ft=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var xt=function(e){return ht.test(e)||ft.test(e)},yt=function(){for(var e=document.querySelectorAll('script[src^="'.concat(Re,'"]')),r=0;r<e.length;r++){var n=e[r];if(xt(n.src))return n}return null},xe=function(e){var r="",n=document.createElement("script");n.src="".concat(pt).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},vt=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.1.0",startTime:r})},U=null,H=null,J=null,gt=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},jt=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},bt=function(e){return U!==null?U:(U=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var a=yt();if(!(a&&e)){if(!a)a=xe(e);else if(a&&J!==null&&H!==null){var o;a.removeEventListener("load",J),a.removeEventListener("error",H),(o=a.parentNode)===null||o===void 0||o.removeChild(a),a=xe(e)}}J=jt(r,n),H=gt(n),a.addEventListener("load",J),a.addEventListener("error",H)}catch(l){n(l);return}}),U.catch(function(r){return U=null,Promise.reject(r)}))},Nt=function(e,r,n){if(e===null)return null;var a=r[0],o=a.match(/^pk_test/),l=mt(e.version),d=Te;o&&l!==d&&console.warn("Stripe.js@".concat(l," was loaded on the page, but @stripe/stripe-js@").concat("8.1.0"," expected Stripe.js@").concat(d,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var i=e.apply(void 0,r);return vt(i,n),i},z,Ie=!1,Ae=function(){return z||(z=bt(null).catch(function(e){return z=null,Promise.reject(e)}),z)};Promise.resolve().then(function(){return Ae()}).catch(function(s){Ie||console.warn(s)});var wt=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];Ie=!0;var a=Date.now();return Ae().then(function(o){return Nt(o,r,a)})},se={exports:{}},ne,ye;function Ct(){if(ye)return ne;ye=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ne=s,ne}var ae,ve;function St(){if(ve)return ae;ve=1;var s=Ct();function e(){}function r(){}return r.resetWarningCache=e,ae=function(){function n(l,d,i,f,u,x){if(x!==s){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function a(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:a,element:n,elementType:n,instanceOf:a,node:n,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},ae}var ge;function Et(){return ge||(ge=1,se.exports=St()()),se.exports}var Pt=Et();const p=ot(Pt);function je(s,e){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function be(s){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?je(Object(r),!0).forEach(function(n){$e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function K(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?K=function(e){return typeof e}:K=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(s)}function $e(s,e,r){return e in s?Object.defineProperty(s,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[e]=r,s}function kt(s,e){if(s==null)return{};var r={},n=Object.keys(s),a,o;for(o=0;o<n.length;o++)a=n[o],!(e.indexOf(a)>=0)&&(r[a]=s[a]);return r}function Ot(s,e){if(s==null)return{};var r=kt(s,e),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);for(a=0;a<o.length;a++)n=o[a],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function Fe(s,e){return Tt(s)||Rt(s,e)||It(s,e)||At()}function Tt(s){if(Array.isArray(s))return s}function Rt(s,e){var r=s&&(typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"]);if(r!=null){var n=[],a=!0,o=!1,l,d;try{for(r=r.call(s);!(a=(l=r.next()).done)&&(n.push(l.value),!(e&&n.length===e));a=!0);}catch(i){o=!0,d=i}finally{try{!a&&r.return!=null&&r.return()}finally{if(o)throw d}}return n}}function It(s,e){if(s){if(typeof s=="string")return Ne(s,e);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ne(s,e)}}function Ne(s,e){(e==null||e>s.length)&&(e=s.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=s[r];return n}function At(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var b=function(e,r,n){var a=!!n,o=h.useRef(n);h.useEffect(function(){o.current=n},[n]),h.useEffect(function(){if(!a||!e)return function(){};var l=function(){o.current&&o.current.apply(o,arguments)};return e.on(r,l),function(){e.off(r,l)}},[a,r,e,o])},ie=function(e){var r=h.useRef(e);return h.useEffect(function(){r.current=e},[e]),r.current},M=function(e){return e!==null&&K(e)==="object"},$t=function(e){return M(e)&&typeof e.then=="function"},Ft=function(e){return M(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},we="[object Object]",_t=function s(e,r){if(!M(e)||!M(r))return e===r;var n=Array.isArray(e),a=Array.isArray(r);if(n!==a)return!1;var o=Object.prototype.toString.call(e)===we,l=Object.prototype.toString.call(r)===we;if(o!==l)return!1;if(!o&&!n)return e===r;var d=Object.keys(e),i=Object.keys(r);if(d.length!==i.length)return!1;for(var f={},u=0;u<d.length;u+=1)f[d[u]]=!0;for(var x=0;x<i.length;x+=1)f[i[x]]=!0;var c=Object.keys(f);if(c.length!==d.length)return!1;var y=e,E=r,k=function(F){return s(y[F],E[F])};return c.every(k)},_e=function(e,r,n){return M(e)?Object.keys(e).reduce(function(a,o){var l=!M(r)||!_t(e[o],r[o]);return n.includes(o)?(l&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),a):l?be(be({},a||{}),{},$e({},o,e[o])):a},null):null},qe="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Ce=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe;if(e===null||Ft(e))return e;throw new Error(r)},qt=function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qe;if($t(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(a){return Ce(a,r)})};var n=Ce(e,r);return n===null?{tag:"empty"}:{tag:"sync",stripe:n}},Lt=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"5.2.0"}),e.registerAppInfo({name:"react-stripe-js",version:"5.2.0",url:"https://stripe.com/docs/stripe-js/react"}))},Z=h.createContext(null);Z.displayName="ElementsContext";var Le=function(e,r){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(r," in an <Elements> provider."));return e},Me=function(e){var r=e.stripe,n=e.options,a=e.children,o=h.useMemo(function(){return qt(r)},[r]),l=h.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(n):null}}),d=Fe(l,2),i=d[0],f=d[1];h.useEffect(function(){var c=!0,y=function(k){f(function(A){return A.stripe?A:{stripe:k,elements:k.elements(n)}})};return o.tag==="async"&&!i.stripe?o.stripePromise.then(function(E){E&&c&&y(E)}):o.tag==="sync"&&!i.stripe&&y(o.stripe),function(){c=!1}},[o,i,n]);var u=ie(r);h.useEffect(function(){u!==null&&u!==r&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[u,r]);var x=ie(n);return h.useEffect(function(){if(i.elements){var c=_e(n,x,["clientSecret","fonts"]);c&&i.elements.update(c)}},[n,x,i.elements]),h.useEffect(function(){Lt(i.stripe)},[i.stripe]),h.createElement(Z.Provider,{value:i},a)};Me.propTypes={stripe:p.any,options:p.object};var Mt=function(e){var r=h.useContext(Z);return Le(r,e)},Wt=function(){var e=Mt("calls useElements()"),r=e.elements;return r};p.func.isRequired;var We=h.createContext(null);We.displayName="CheckoutContext";p.any,p.shape({clientSecret:p.oneOfType([p.string,p.instanceOf(Promise)]).isRequired,elementsOptions:p.object}).isRequired;var oe=function(e){var r=h.useContext(We),n=h.useContext(Z);if(r){if(n)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return r}else return Le(n,e)},Ut=["mode"],zt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},C=function(e,r){var n="".concat(zt(e),"Element"),a=function(i){var f=i.id,u=i.className,x=i.options,c=x===void 0?{}:x,y=i.onBlur,E=i.onFocus,k=i.onReady,A=i.onChange,F=i.onEscape,_=i.onClick,m=i.onLoadError,N=i.onLoaderStart,O=i.onNetworksChange,$=i.onConfirm,P=i.onCancel,L=i.onShippingAddressChange,W=i.onShippingRateChange,Ge=i.onSavedPaymentMethodRemove,He=i.onSavedPaymentMethodUpdate,Y=oe("mounts <".concat(n,">")),V="elements"in Y?Y.elements:null,q="checkoutState"in Y?Y.checkoutState:null,T=q?.type==="success"||q?.type==="loading"?q.sdk:null,Je=h.useState(null),de=Fe(Je,2),v=de[0],Ke=de[1],R=h.useRef(null),ee=h.useRef(null);b(v,"blur",y),b(v,"focus",E),b(v,"escape",F),b(v,"click",_),b(v,"loaderror",m),b(v,"loaderstart",N),b(v,"networkschange",O),b(v,"confirm",$),b(v,"cancel",P),b(v,"shippingaddresschange",L),b(v,"shippingratechange",W),b(v,"savedpaymentmethodremove",Ge),b(v,"savedpaymentmethodupdate",He),b(v,"change",A);var te;k&&(e==="expressCheckout"?te=k:te=function(){k(v)}),b(v,"ready",te),h.useLayoutEffect(function(){if(R.current===null&&ee.current!==null&&(V||T)){var g=null;if(T)switch(e){case"payment":g=T.createPaymentElement(c);break;case"address":if("mode"in c){var me=c.mode,pe=Ot(c,Ut);if(me==="shipping")g=T.createShippingAddressElement(pe);else if(me==="billing")g=T.createBillingAddressElement(pe);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":g=T.createExpressCheckoutElement(c);break;case"currencySelector":g=T.createCurrencySelectorElement();break;case"taxId":g=T.createTaxIdElement(c);break;default:throw new Error("Invalid Element type ".concat(n,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else V&&(g=V.create(e,c));R.current=g,Ke(g),g&&g.mount(ee.current)}},[V,T,c]);var ue=ie(c);return h.useEffect(function(){if(R.current){var g=_e(c,ue,["paymentRequest"]);g&&"update"in R.current&&R.current.update(g)}},[c,ue]),h.useLayoutEffect(function(){return function(){if(R.current&&typeof R.current.destroy=="function")try{R.current.destroy(),R.current=null}catch{}}},[]),h.createElement("div",{id:f,className:u,ref:ee})},o=function(i){oe("mounts <".concat(n,">"));var f=i.id,u=i.className;return h.createElement("div",{id:f,className:u})},l=r?o:a;return l.propTypes={id:p.string,className:p.string,onChange:p.func,onBlur:p.func,onFocus:p.func,onReady:p.func,onEscape:p.func,onClick:p.func,onLoadError:p.func,onLoaderStart:p.func,onNetworksChange:p.func,onConfirm:p.func,onCancel:p.func,onShippingAddressChange:p.func,onShippingRateChange:p.func,onSavedPaymentMethodRemove:p.func,onSavedPaymentMethodUpdate:p.func,options:p.object},l.displayName=n,l.__elementType=e,l},S=typeof window>"u",Bt=h.createContext(null);Bt.displayName="EmbeddedCheckoutProviderContext";var Yt=function(){var e=oe("calls useStripe()"),r=e.stripe;return r};C("auBankAccount",S);C("card",S);C("cardNumber",S);C("cardExpiry",S);C("cardCvc",S);C("iban",S);var Vt=C("payment",S);C("expressCheckout",S);C("paymentRequestButton",S);C("linkAuthentication",S);C("address",S);C("shippingAddress",S);C("paymentMethodMessaging",S);C("taxId",S);const Gt=Xe,Ht=Qe,Ue=w.forwardRef(({className:s,...e},r)=>t.jsx(ke,{ref:r,className:B("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...e}));Ue.displayName=ke.displayName;const ze=w.forwardRef(({className:s,children:e,...r},n)=>t.jsxs(Ht,{children:[t.jsx(Ue,{}),t.jsxs(Se,{ref:n,className:B("fixed left-[50%] top-[50%] z-50 w-full max-w-lg max-h-[90vh] translate-x-[-50%] translate-y-[-50%] border bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg overflow-hidden flex flex-col",s),...r,children:[t.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e}),t.jsxs(De,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground z-10",children:[t.jsx(Oe,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ze.displayName=Se.displayName;const Be=({className:s,...e})=>t.jsx("div",{className:B("flex flex-col space-y-1.5 text-center sm:text-left",s),...e});Be.displayName="DialogHeader";const Ye=w.forwardRef(({className:s,...e},r)=>t.jsx(Ee,{ref:r,className:B("text-lg font-semibold leading-none tracking-tight",s),...e}));Ye.displayName=Ee.displayName;const Ve=w.forwardRef(({className:s,...e},r)=>t.jsx(Pe,{ref:r,className:B("text-sm text-muted-foreground",s),...e}));Ve.displayName=Pe.displayName;class Jt{async createPaymentIntent(e){try{return(await re.post("/payment/create-payment-intent",e)).data.data}catch(r){throw console.error("Failed to create payment intent:",r),new Error(r.response?.data?.message||"Failed to create payment intent")}}async getPaymentIntent(e){try{return(await re.get(`/payment/payment-intent/${e}`)).data.data}catch(r){throw console.error("Failed to get payment intent:",r),new Error(r.response?.data?.message||"Failed to get payment details")}}async cancelPaymentIntent(e){try{return(await re.post(`/payment/cancel-payment-intent/${e}`)).data.data}catch(r){throw console.error("Failed to cancel payment intent:",r),new Error(r.response?.data?.message||"Failed to cancel payment")}}}const Kt=new Jt,Xt=wt("pk_test_TYooMQauvdEDq54NiTphI7jx"),Qt=({amount:s,onSuccess:e,onError:r,onCancel:n})=>{const a=Yt(),o=Wt(),[l,d]=w.useState(!1),[i,f]=w.useState(null),u=async x=>{if(x.preventDefault(),!(!a||!o)){d(!0),f(null);try{const{error:c,paymentIntent:y}=await a.confirmPayment({elements:o,confirmParams:{return_url:`${window.location.origin}/order-confirmation`},redirect:"if_required"});c?(f(c.message||"Payment failed"),r(c.message||"Payment failed"),I.error(c.message||"Payment failed")):y&&y.status==="succeeded"&&(I.success("Payment successful!"),e(y.id))}catch(c){const y=c.message||"An unexpected error occurred";f(y),r(y),I.error(y)}finally{d(!1)}}};return t.jsx("div",{className:"flex flex-col h-full",children:t.jsxs("form",{onSubmit:u,className:"flex flex-col h-full space-y-6",children:[t.jsxs("div",{className:"flex-1 space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Amount to pay"}),t.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["¬£",s.toFixed(2)]})]}),t.jsx("p",{className:"text-xs text-gray-500",children:"Secure payment powered by Stripe"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(lt,{className:"w-4 h-4"}),t.jsx("span",{children:"Your payment information is encrypted and secure"})]}),t.jsx(Vt,{})]}),i&&t.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-lg text-sm",children:i})]}),t.jsx("div",{className:"flex-shrink-0 pt-4 border-t",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx(j,{type:"button",variant:"outline",onClick:n,disabled:l,className:"flex-1",children:"Cancel"}),t.jsx(j,{type:"submit",disabled:!a||l,className:"flex-1",children:l?t.jsxs(t.Fragment,{children:[t.jsx(ce,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(D,{className:"w-4 h-4 mr-2"}),"Pay ¬£",s.toFixed(2)]})})]})})]})})},Dt=({isOpen:s,onClose:e,amount:r,customerEmail:n,customerName:a,onPaymentSuccess:o,onPaymentError:l})=>{const[d,i]=w.useState(null),[f,u]=w.useState(!0);w.useEffect(()=>{s&&r>0&&x()},[s,r]);const x=async()=>{u(!0);try{const E=await Kt.createPaymentIntent({amount:r,customerEmail:n,customerName:a,metadata:{customer_name:a,customer_email:n}});i(E.clientSecret)}catch(E){console.error("Failed to create payment intent:",E),I.error("Failed to initialize payment. Please try again."),e()}finally{u(!1)}},c=()=>{i(null),e()},y={theme:"stripe",variables:{colorPrimary:"#0F172A",borderRadius:"8px"}};return t.jsx(Gt,{open:s,onOpenChange:c,children:t.jsxs(ze,{className:"w-[95vw] max-w-[500px] max-h-[90vh] flex flex-col mx-auto",children:[t.jsxs(Be,{className:"flex-shrink-0 px-1",children:[t.jsxs(Ye,{className:"flex items-center gap-2 text-lg",children:[t.jsx(D,{className:"w-5 h-5"}),"Complete Payment"]}),t.jsx(Ve,{className:"text-sm",children:"Enter your card details to complete your order"})]}),t.jsx("div",{className:"flex-1 overflow-y-auto px-1",children:f?t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 space-y-4",children:[t.jsx(ce,{className:"w-8 h-8 animate-spin text-primary"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Initializing payment..."})]}):d?t.jsx(Me,{stripe:Xt,options:{clientSecret:d,appearance:y},children:t.jsx(Qt,{amount:r,onSuccess:o,onError:l,onCancel:c})}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-red-600",children:"Failed to initialize payment"}),t.jsx(j,{onClick:x,className:"mt-4",children:"Retry"})]})})]})})},Zt=()=>{const{state:s,clearCart:e}=le(),[r,n]=w.useState(!1),[a,o]=w.useState("delivery"),[l,d]=w.useState(!1),[i,f]=w.useState({name:"",phone:"",email:"",address:{street:"",city:"Epping",postcode:"CM16 4BA"},paymentMethod:"card"}),u=(m,N)=>{if(m.includes(".")){const[O,$]=m.split(".");f(P=>({...P,[O]:{...P[O],[$]:N}}))}else f(O=>({...O,[m]:N}))},x=async(m,N,O,$,P)=>{try{const L={orderId:m,customerName:N.name,customerEmail:N.email,customerPhone:N.phone,orderType:P,items:O.map(W=>({name:W.name,quantity:W.quantity,price:W.price})),total:$,deliveryAddress:P==="delivery"?N.address:void 0,paymentMethod:P==="delivery"?"cash_on_delivery":"pay_at_pickup",specialInstructions:N.specialInstructions};await fe.sendOrderConfirmationEmail(L),await fe.sendRestaurantNotificationEmail(L),console.log("Order emails sent successfully")}catch(L){console.error("Failed to send order emails:",L)}},c=async m=>{if(m.preventDefault(),!i.name||!i.phone||!i.email){I.error("Please fill in all required fields");return}if(a==="delivery"&&!i.address.street){I.error("Please provide delivery address");return}d(!0)},y=async m=>{d(!1),n(!0);try{const N={status:"pending",customerInfo:{name:i.name,phone:i.phone,email:i.email,address:a==="delivery"?`${i.address.street}, ${i.address.city}, ${i.address.postcode}`:void 0,paymentMethod:"card"},items:s.items.map(P=>({name:P.name,quantity:P.quantity,price:P.price,brand:P.brand})),total:_,orderType:a,paymentIntentId:m},$=(await at.storeOrder(N))?._id||"N/A";await x($,i,s.items,_,a),I.success(`Order submitted successfully! Order ID: ${$.slice(-8)}`),e(),f({name:"",phone:"",email:"",address:{street:"",city:"Epping",postcode:"CM16 4BA"},paymentMethod:"card"})}catch(N){console.error("Order submission error:",N),I.error("Failed to submit order. Please contact support with your payment confirmation.")}finally{n(!1)}},E=m=>{d(!1),I.error(`Payment failed: ${m}`)},k=()=>{d(!1)},A=a==="delivery"?2.5:0,F=1.5,_=s.total+A+F;return t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs(X,{children:[t.jsx(et,{children:t.jsx(tt,{className:"text-2xl font-bold",children:"Checkout"})}),t.jsxs(Q,{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Order Type"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(j,{type:"button",variant:a==="delivery"?"default":"outline",onClick:()=>o("delivery"),className:"h-12",children:"üöö Delivery"}),t.jsx(j,{type:"button",variant:a==="pickup"?"default":"outline",onClick:()=>o("pickup"),className:"h-12",children:"üè™ Pickup"})]})]}),t.jsxs("form",{onSubmit:c,className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Customer Information"}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Full Name *"}),t.jsx("input",{type:"text",id:"name",value:i.name,onChange:m=>u("name",m.target.value),className:"w-full p-3 border rounded-lg",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium mb-1",children:"Phone Number *"}),t.jsx("input",{type:"tel",id:"phone",value:i.phone,onChange:m=>u("phone",m.target.value),className:"w-full p-3 border rounded-lg",required:!0})]})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-1",children:"Email Address *"}),t.jsx("input",{type:"email",id:"email",value:i.email,onChange:m=>u("email",m.target.value),className:"w-full p-3 border rounded-lg",required:!0})]})]}),a==="delivery"&&t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Delivery Address"}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"street",className:"block text-sm font-medium mb-1",children:"Street Address *"}),t.jsx("input",{type:"text",id:"street",value:i.address.street,onChange:m=>u("address.street",m.target.value),className:"w-full p-3 border rounded-lg",placeholder:"123 Main Street",required:!0})]}),t.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"city",className:"block text-sm font-medium mb-1",children:"City"}),t.jsx("input",{type:"text",id:"city",value:i.address.city,onChange:m=>u("address.city",m.target.value),className:"w-full p-3 border rounded-lg",readOnly:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"postcode",className:"block text-sm font-medium mb-1",children:"Postcode"}),t.jsx("input",{type:"text",id:"postcode",value:i.address.postcode,onChange:m=>u("address.postcode",m.target.value),className:"w-full p-3 border rounded-lg",readOnly:!0})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Special Instructions"}),t.jsx("textarea",{value:i.specialInstructions||"",onChange:m=>u("specialInstructions",m.target.value),className:"w-full p-3 border rounded-lg",rows:3,placeholder:"Any special requests or dietary requirements..."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Order Summary"}),t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{children:["Subtotal (",s.itemCount," items)"]}),t.jsxs("span",{children:["¬£",s.total.toFixed(2)]})]}),a==="delivery"&&t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Delivery Fee"}),t.jsxs("span",{children:["¬£",A.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Service Fee"}),t.jsxs("span",{children:["¬£",F.toFixed(2)]})]}),t.jsx("div",{className:"border-t pt-2",children:t.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[t.jsx("span",{children:"Total"}),t.jsxs("span",{children:["¬£",_.toFixed(2)]})]})})]})]}),t.jsx(j,{type:"submit",className:"w-full h-12 text-lg",disabled:r,children:r?t.jsxs(t.Fragment,{children:[t.jsx(ce,{className:"w-5 h-5 mr-2 animate-spin"}),"Processing Order..."]}):t.jsxs(t.Fragment,{children:[t.jsx(D,{className:"w-5 h-5 mr-2"}),"Proceed to Payment - ¬£",_.toFixed(2)]})})]})]})]}),t.jsx(Dt,{isOpen:l,onClose:k,amount:_,customerEmail:i.email,customerName:i.name,onPaymentSuccess:y,onPaymentError:E})]})},ir=()=>{const{state:s,clearCart:e}=le(),{items:r,total:n,itemCount:a}=s,[o,l]=w.useState(!1),d=n>0?2.5:0,i=n>0?1.5:0,f=n+d+i;return r.length===0?t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto section-padding px-4 sm:px-6",children:t.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[t.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 bg-secondary rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6",children:t.jsx(rt,{className:"w-10 h-10 sm:w-12 sm:h-12 text-muted-foreground"})}),t.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-heading font-bold mb-3 sm:mb-4",children:"Your Cart is Empty"}),t.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-6 sm:mb-8 px-4",children:"Looks like you haven't added any delicious items yet. Explore our amazing food options and add something to your cart!"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center",children:[t.jsx(j,{asChild:!0,className:"btn-hero min-h-[44px] w-full sm:w-auto",children:t.jsx(G,{to:"/ohsmash",children:"Try OhSmash Burgers"})}),t.jsx(j,{asChild:!0,variant:"outline",className:"min-h-[44px] w-full sm:w-auto",children:t.jsx(G,{to:"/wonder-wings",children:"Try Wonder Wings"})}),t.jsx(j,{asChild:!0,variant:"outline",className:"min-h-[44px] w-full sm:w-auto",children:t.jsx(G,{to:"/okra-green",children:"Try Okra Green"})})]})]})})}):o?t.jsx("div",{className:"min-h-screen bg-background",children:t.jsxs("div",{className:"container mx-auto section-padding px-4 sm:px-6",children:[t.jsx("div",{className:"mb-4 sm:mb-6",children:t.jsxs(j,{variant:"ghost",onClick:()=>l(!1),className:"flex items-center space-x-2 min-h-[44px]",children:[t.jsx(he,{className:"w-4 h-4"}),t.jsx("span",{children:"Back to Cart"})]})}),t.jsx(Zt,{})]})}):t.jsx("div",{className:"min-h-screen bg-background",children:t.jsx("div",{className:"container mx-auto section-padding px-4 sm:px-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 sm:mb-8 gap-4",children:[t.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[t.jsx(j,{asChild:!0,variant:"ghost",size:"sm",className:"min-h-[44px]",children:t.jsxs(G,{to:"/",className:"flex items-center space-x-2",children:[t.jsx(he,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Continue Shopping"}),t.jsx("span",{className:"sm:hidden",children:"Back"})]})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-heading font-bold",children:"Your Cart"}),t.jsxs("p",{className:"text-sm sm:text-base text-muted-foreground",children:[a," item",a!==1?"s":""]})]})]}),t.jsxs(j,{variant:"outline",size:"sm",onClick:e,className:"text-destructive hover:text-destructive min-h-[44px] w-full sm:w-auto",children:[t.jsx(it,{className:"w-4 h-4 mr-2"}),"Clear Cart"]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 sm:gap-8",children:[t.jsx("div",{className:"lg:col-span-2 space-y-3 sm:space-y-4",children:r.map((u,x)=>t.jsx(dt,{item:u},u.id||`cart-item-${x}`))}),t.jsxs("div",{className:"lg:col-span-1",children:[t.jsx(X,{className:"sticky top-4",children:t.jsxs(Q,{className:"p-4 sm:p-6",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-heading font-bold mb-4 sm:mb-6",children:"Order Summary"}),t.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[t.jsxs("div",{className:"flex justify-between text-sm sm:text-base",children:[t.jsxs("span",{children:["Subtotal (",a," items)"]}),t.jsxs("span",{children:["¬£",n.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between text-sm sm:text-base",children:[t.jsx("span",{children:"Delivery Fee"}),t.jsxs("span",{children:["¬£",d.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between text-sm sm:text-base",children:[t.jsx("span",{children:"Service Fee"}),t.jsxs("span",{children:["¬£",i.toFixed(2)]})]}),t.jsx("div",{className:"border-t pt-3 sm:pt-4",children:t.jsxs("div",{className:"flex justify-between text-base sm:text-lg font-semibold",children:[t.jsx("span",{children:"Total"}),t.jsxs("span",{children:["¬£",f.toFixed(2)]})]})})]}),t.jsxs(j,{className:"w-full btn-hero mt-4 sm:mt-6 min-h-[44px]",size:"lg",onClick:()=>l(!0),children:[t.jsx(D,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2"}),"Proceed to Checkout"]}),t.jsx("p",{className:"text-xs text-muted-foreground text-center mt-3 sm:mt-4",children:"Complete your order with FoodHub integration"})]})}),t.jsx(X,{className:"mt-3 sm:mt-4",children:t.jsxs(Q,{className:"p-3 sm:p-4",children:[t.jsx("h3",{className:"font-semibold mb-2 text-sm sm:text-base",children:"Delivery Information"}),t.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground space-y-1",children:[t.jsx("p",{children:"‚Ä¢ Free delivery on orders over ¬£25"}),t.jsx("p",{children:"‚Ä¢ Estimated delivery: 30-45 minutes"}),t.jsx("p",{children:"‚Ä¢ We'll call you when your order is ready"})]})]})})]})]})]})})})};export{ir as default};
